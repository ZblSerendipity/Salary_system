<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>工资管理主页</title>
    <link rel="stylesheet" href="css/bootstrap.css"/>
    <link rel="stylesheet" type="text/css" href="../layui/css/layui.css"/>
	<script type="text/javascript" rel="stylesheet" src="../js/jquery-1.12.4.js"></script>
	<script type="text/javascript" rel="stylesheet" src="../js/ajaxUtil.js"></script>
    <script type="text/javascript" src="../layui/layui.js"></script>

</head>
<body class="layui-layout-body">

<!--顶端导航-->

<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <div class="layui-logo ">企业工资管理系统</div>
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item" lay-unselect="">
                <a href="javascript:;"><img src="//t.cn/RCzsdCq" class="layui-nav-img"><span id="name">xingming</span></a>
                <dl class="layui-nav-child">
                    <dd><a href="">公告信息</a></dd>

                </dl>
            </li>
            <!--<li class="layui-nav-item">
                  用户欢迎您！
            </li>-->
            <li class="layui-nav-item"><a href="#" style="text-decoration:none">退出登录</a></li>
        </ul>

    </div>

    <!--侧边栏导航-->
    <div  class="layui-side layui-bg-black">
        <ul class="layui-nav layui-nav-tree layui-inline" lay-filter="demo" style="margin-right: 10px;">
            <li class="layui-nav-item layui-nav-itemed">
				<a  href="http://localhost:8080/html/mainpage.html">主页</a>
				<dl class="layui-nav-child">
					<dd><a class="layui-this" href="http://localhost:8080/html/modifyPage.html">修改信息</a></dd>
				</dl>
            </li>
            <!--工资信息表，奖惩记录，工资数据图展示过去12个月的工资图-->
            <li class="layui-nav-item">
				<a href="http://localhost:8080/html/salaryPage.html">我的工资信息</a>
            </li>
            <li class="layui-nav-item">
				<a  href="http://localhost:8080/html/boardManage.html">公告管理</a>
				<dl class="layui-nav-child">
					<dd><a href="http://localhost:8080/html/boardPage.html">公告发布</a></dd>
				</dl>
            </li>
            <!--管理员工工资，员工信息-->
            <li class="layui-nav-item">
				<a href="http://localhost:8080/html/stuffManagePage.html">员工管理</a>
				<dl class="layui-nav-child">
					<dd><a href="http://localhost:8080/html/salaryManagePage.html">员工工资管理</a></dd>
				</dl>
            </li>

            <!--角色权限管理-->
            <li class="layui-nav-item"><a href="http://localhost:8080/html/powerPage.html">角色管理</a></li>
        </ul>
    </div>

    <!-- 内容主体区域 -->
    <div class="layui-body" style="background: #F0F0F0; margin-bottom: -45px;">
	    <div style="padding: 30px;">
	    	
	    	<div class="layui-card">
	    		<div class="layui-card-body">
	    			<div class="layui-upload">
					  <div class="layui-upload-list">
					    <img src="//t.cn/RCzsdCq" class="layui-upload-img" id="image-img" style="height: 100px; width: 100px; border-radius: 50px;">
					    <p id="demoText"></p>
					    <button type="button" class="layui-btn" id="image-btn">修改头像</button>
					  </div>
					</div> 
	    		</div>
	    	<div class="layui-card-body" style="padding-top: 40px;">
	    	<form class="layui-form" action="" method="post">
			  <div class="layui-form-item">
			    <div class="layui-inline">
			    	
			      <label class="layui-form-label" style="width: 170px;"><i class="layui-icon layui-icon-tabs" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>职工号：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="stu_num" class="layui-input" disabled="disabled" id="unum">
			      </div>
			    </div>
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-username" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>姓名：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="name" id="xm" class="layui-input">
			      </div>
			    </div>
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-group" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>职位：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="position" id="position" disabled="disabled" class="layui-input">
			      </div>
			    </div>
			  </div>
			  
			  <div class="layui-form-item">
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-male" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>性别：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="gender" id="gender" disabled="disabled" class="layui-input">
			      </div>
			    </div>
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-light" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>年龄：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="age" id="age" lay-verify="age" class="layui-input">
			      </div>
			    </div>
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-note" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>银行账号：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="bankid" id="bankid" disabled="disabled" class="layui-input">
			      </div>
			    </div>
			  </div>
			  
			  <div class="layui-form-item">
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-template-1" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>工龄：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="seniority" id="seniority" lay-verify="seniority" class="layui-input">
			      </div>
			    </div>
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-form" style="font-size: 30px; color: #1E9FFF; margin: 20px;"></i>工资：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="salary" id="salary" disabled="disabled" class="layui-input">
			      </div>
			    </div>
			    <div class="layui-inline">
			      <label class="layui-form-label"  style="width: 170px;"><i class="layui-icon layui-icon-layer" style="font-size: 30px; color: #1E9FFF; margin: 27px;"></i>身份证：</label>
			      <div class="layui-input-inline">
			        <input type="text" name="pid" id="pid" lay-verify="identity" autocomplete="off" class="layui-input">
			      </div>
			    </div>
			  </div>
			  
			  <div class="layui-form-item">
			    <div class="layui-inline">
			      <div class="layui-input-inline">
			      	<label class="layui-form-label"  style="width: 100px;">
			      		<input type="submit" class="layui-btn" lay-submit="" lay-filter="L_submit" value="提交修改" style="margin-left: 85px;"/>
			      	</label>
			      </div>
			    </div>
			  </div>
			</form>
	    	</div>
	    	</div>
	    </div>
    </div>
</div>

</body>
<script type="text/javascript">
    layui.use('element', function(){
        var element = layui.element;

    });

	layui.use(['form','util'], function() {
		var form = layui.form;
		var util = layui.util;
		var reg = /^\d+$|^\d+[.]?\d+$/;
		form.verify({
			age: function(value) {
				if(!value.match(reg)) {
					return '请输入规范数值！';
				}
				if (Number(value) < 18 || Number(value) > 65) {
					return '年龄未在18岁到65岁之间，不符合规定！';
				}
			}
			// ,pass: [
			// 	/^[\S]{6,12}$/
			// 	,'密码必须6到12位，且不能出现空格'
			// ]
			,seniority: function(value) {
				if(!value.match(reg)) {
					return '请输入规范数值！';
				}
				if (Number(value) < 0 || Number(value) > 47) {
					return '工龄不符合规范！';
				}
			}
		});

		form.on('submit(L_submit)', function(data) {
			var age=util.escape($("#age").val());
			var uname=util.escape($("#xm").val());
			var pid=util.escape($("#pid").val());


			$.ajax({
				type:'POST',
				url:'/Info/updateInfo',
				data:{age:age, uname:uname, pid:pid},
				success:function(data){
					layer.alert("修改成功！");
				},
				error:function() {
					layer.alert("修改失败！");
				}
			});

			// $.post(
			// 		'/Info/updateInfo',
			// 		{age:age, uname:uname, pid:pid},
			// 		function(data){
			// 			alert(data);
			// 			if (data == 1){
			// 				layer.alert("修改成功！");
			// 			}else {
			// 				layer.alert("修改失败！");
			// 			}
			// 		}
			// )
			return false;
		});
	})
</script>

<script>
	window.onload = function() {
		ajax({
			method:HTTP_METHOD.POST,
			url:"/Info/getInfo",
			async:true,
			type:HTTP_RESPONSE_TYPE.JSON,
			callback:(data)=>{

				var json = eval(data);
				// alert(json.uname);
				$("#name").text(json.uname);
				$("#xm").val(json.uname);
				$("#unum").val(json.unum);
				$("#gender").val(json.gender);
				$("#age").val(json.age);
				$("#seniority").val(json.seniority);
				$("#salary").val(json.salary);
				$("#bankid").val(json.bankid) ;
				$("#position").val(json.position) ;
				$("#pid").val(json.pid)
			}
		})
	}
</script>
</html>